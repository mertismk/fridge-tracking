# Fridge Tracking

Приложение для отслеживания продуктов в холодильнике. Помогает контролировать сроки годности продуктов, их количество и избегать просроченных товаров.

## Запуск с Docker

### Предварительные требования
- Docker Desktop установлен на вашем компьютере

### Первый запуск

1. Остановите и удалите все существующие Docker контейнеры (если нужно):
```bash
docker stop $(docker ps -a -q)
docker rm $(docker ps -a -q)
```

2. Удалите все Docker образы, если нужно начать с чистого состояния:
```bash
docker rmi $(docker images -q)
```

3. Удалите предыдущие тома базы данных (если есть):
```bash
docker volume prune -f
```

4. Запустите приложение с Docker Compose:
```bash
docker-compose up -d --build
```

5. Проверьте логи, чтобы убедиться, что всё запустилось правильно:
```bash
docker-compose logs -f
```

6. Приложение будет доступно по адресу: http://localhost:5000

### Перезапуск после изменений

Если вы внесли изменения в код:
```bash
docker-compose down
docker-compose up -d --build
```

### Остановка приложения

```bash
docker-compose down
```

## База данных

PostgreSQL база данных будет автоматически инициализирована при первом запуске. Данные сохраняются в файле `fridge_planner.db`. Начальные тестовые данные также будут добавлены автоматически.

## Вход в систему


Логин администратора: `admin`
Email: `admin@example.com`

## Функциональность

- Добавление продуктов с указанием категории, количества, единицы измерения и срока годности
- Отслеживание сроков годности продуктов
- Система ранжирования продуктов по длительности хранения ("Новобранец", "Новосёл", "Постоялец" и т.д.)
- Автоматический расчет оставшихся дней до истечения срока годности
- Учетные записи пользователей для хранения личных списков продуктов
- Список покупок с автоматическими предложениями на основе заканчивающихся продуктов
- Умные рекомендации часто покупаемых продуктов для быстрого добавления в список 

## Мониторинг и Observability

Приложение интегрировано с Prometheus и Grafana для мониторинга и визуализации метрик:

### Доступные метрики

- **HTTP метрики**: Количество запросов, продолжительность запросов, исключения
- **Бизнес-метрики**: 
  - Количество добавленных/удаленных продуктов
  - Количество просроченных продуктов
  - Количество продуктов с истекающим сроком годности
  - Распределение продуктов по категориям
  - Количество добавленных/приобретенных товаров из списка покупок

### Доступ к системам мониторинга

- **Prometheus**: http://localhost:9090
- **Grafana**: http://localhost:3000 (логин: admin, пароль: admin)

Предустановленные дашборды Grafana:
- Flask Metrics Dashboard - основные метрики веб-приложения

## CI/CD

Приложение настроено на автоматический CI/CD процесс с использованием TeamCity:

1. При коммите в ветку dev автоматически запускается сборка.
2. Образ Docker собирается и публикуется в Docker Hub с тегом latest.
3. Приложение автоматически деплоится на stage-сервер.

### Доступ к stage-серверу

После успешного деплоя приложение доступно по адресу: http://stage-server:5000
